{"remainingRequest":"D:\\桌面\\vdocs-plus\\node_modules\\babel-loader\\lib\\index.js!D:\\桌面\\vdocs-plus\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\桌面\\vdocs-plus\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\桌面\\vdocs-plus\\src\\components\\comment\\h-comment.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\桌面\\vdocs-plus\\src\\components\\comment\\h-comment.vue","mtime":1660971313631},{"path":"D:\\桌面\\vdocs-plus\\babel.config.js","mtime":1658807783766},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661267353134},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\babel-loader\\lib\\index.js","mtime":1661267356503},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661267353134},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\vue-loader\\lib\\index.js","mtime":1661267357130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdWIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEhDb21tZW50RGlzcGxheSBmcm9tICJAL2NvbXBvbmVudHMvY29tbWVudC9oLWNvbW1lbnQtZGlzcGxheSI7CmltcG9ydCBIQ29tbWVudEFyZWEgZnJvbSAiQC9jb21wb25lbnRzL2NvbW1lbnQvaC1jb21tZW50LWFyZWEiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkhDb21tZW50IiwKICBjb21wb25lbnRzOiB7CiAgICBIQ29tbWVudEFyZWE6IEhDb21tZW50QXJlYSwKICAgIEhDb21tZW50RGlzcGxheTogSENvbW1lbnREaXNwbGF5CiAgfSwKICBwcm9wczogewogICAgaXNSZXZlcnNlOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNSZXBseVN0YXRlOiB0cnVlLAogICAgICBzdGF0ZXM6IHt9LAogICAgICBpZFRvTmFtZToge30KICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBvblJlcGx5U3RhdGVDaGFuZ2U6IGZ1bmN0aW9uIG9uUmVwbHlTdGF0ZUNoYW5nZShpZCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGNvbW1lbnRzID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1siY29tbWVudC9nZXRDb21tZW50c0J5UGF0aCJdOwoKICAgICAgaWYgKGlkICE9PSAnaW5pdCcpIHsKICAgICAgICB2YXIgc3RhdGUgPSB0aGlzLnN0YXRlc1tpZF07IC8vIOWPluWHuuW9k+WJjeWbnuWkjeeahOeKtuaAgQoKICAgICAgICB0aGlzLmluaXRDb21tZW50SWQoY29tbWVudHMpOyAvLyDliJ3lp4vljJbmiYDku6Xor4TorrrkuIvnmoTnirbmgIHkuLpmYWxzZQoKICAgICAgICB0aGlzLiRzZXQodGhpcy5zdGF0ZXMsIGlkLCAhc3RhdGUpOwogICAgICAgIHRoaXMuaXNSZXBseVN0YXRlID0gT2JqZWN0LmtleXModGhpcy5zdGF0ZXMpLmV2ZXJ5KGZ1bmN0aW9uIChrKSB7CiAgICAgICAgICByZXR1cm4gX3RoaXMuc3RhdGVzW2tdID09PSBmYWxzZTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzUmVwbHlTdGF0ZSA9IHRydWU7CiAgICAgICAgdGhpcy5pbml0Q29tbWVudElkKGNvbW1lbnRzKTsKICAgICAgfQogICAgfSwKICAgIGluaXRDb21tZW50SWQ6IGZ1bmN0aW9uIGluaXRDb21tZW50SWQoY29tbWVudHMpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAoY29tbWVudHMgPT09IG51bGwgfHwgY29tbWVudHMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICAgIGNvbW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBpZiAoaXRlbS5zdWIubGVuZ3RoID4gMCkgewogICAgICAgICAgX3RoaXMyLmluaXRDb21tZW50SWQoaXRlbS5zdWIpOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMyLmlkVG9OYW1lW2l0ZW0uX2lkXSA9IGl0ZW0ubmFtZTsKICAgICAgICBpdGVtLl9pZCAmJiBfdGhpczIuJHNldChfdGhpczIuc3RhdGVzLCBpdGVtLl9pZCwgZmFsc2UpOwogICAgICB9KTsKICAgIH0sCiAgICBjb3VudENvbW1lbnROdW06IGZ1bmN0aW9uIGNvdW50Q29tbWVudE51bShjb21tZW50cykgewogICAgICBpZiAoY29tbWVudHMgPT09IG51bGwgfHwgY29tbWVudHMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICAgIHZhciBuID0gMDsKICAgICAgY29tbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGl0ZW0uc3ViLmxlbmd0aCA+IDAgJiYgKG4gKz0gaXRlbS5zdWIubGVuZ3RoKTsKICAgICAgICBuKys7CiAgICAgIH0pOwogICAgICByZXR1cm4gbjsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICB0aXRsZTogZnVuY3Rpb24gdGl0bGUoKSB7CiAgICAgIHZhciBjb21tZW50cyA9IHRoaXMuJHN0b3JlLmdldHRlcnNbImNvbW1lbnQvZ2V0Q29tbWVudHNCeVBhdGgiXTsKICAgICAgdmFyIG4gPSB0aGlzLmNvdW50Q29tbWVudE51bShjb21tZW50cykgfHwgMDsKICAgICAgdmFyIHRpdGxlID0gJyc7CgogICAgICBpZiAoY29tbWVudHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhdGggIT09ICcvbWVzc2FnZScpIHsKICAgICAgICAgIHRpdGxlID0gJ+aaguaXoOivhOiuuic7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRpdGxlID0gJ+aaguaXoOeVmeiogCc7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRpdGxlID0gJ+WFsScgKyBuICsgJ+adoeivhOiuuic7CiAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhdGggPT09ICcvbWVzc2FnZScpIHRpdGxlID0gJ+WFsScgKyBuICsgJ+adoeeVmeiogCc7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aXRsZTsKICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgX3RoaXMzLmluaXRDb21tZW50SWQoX3RoaXMzLiRzdG9yZS5nZXR0ZXJzWyJjb21tZW50L2dldENvbW1lbnRzQnlQYXRoIl0pOwogICAgfSwgMjAwKTsKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;AAeA;AACA;AAGA;EACAA,gBADA;EAEAC;IAAAC;IAAAC;EAAA,CAFA;EAGAC;IACAC;MAAAC;MAAAC;IAAA;EADA,CAHA;EAMAC,IANA,kBAMA;IACA;MACAC,kBADA;MAEAC,UAFA;MAGAC;IAHA;EAKA,CAZA;EAaAC;IACAC,kBADA,8BACAC,EADA,EACA;MAAA;;MACA;;MACA;QACA,4BADA,CACA;;QAEA,6BAHA,CAGA;;QACA;QACA;UAAA;QAAA;MACA,CANA,MAMA;QACA;QACA;MACA;IACA,CAbA;IAcAC,aAdA,yBAcAC,QAdA,EAcA;MAAA;;MACA;MACAA;QACA;UACA;QACA;;QACA;QACAC;MACA,CANA;IAOA,CAvBA;IAwBAC,eAxBA,2BAwBAF,QAxBA,EAwBA;MACA;MACA;MACAA;QACAC;QACAE;MACA,CAHA;MAIA;IACA;EAhCA,CAbA;EA+CAC;IACAC,KADA,mBACA;MACA;MACA;MACA;;MACA;QACA;UACAA;QACA,CAFA,MAEA;UACAA;QACA;MACA,CANA,MAMA;QACAA;QACA;MACA;;MACA;IACA;EAhBA,CA/CA;EAiEAC,OAjEA,qBAiEA;IAAA;;IACAC;MACA;IACA,CAFA,EAEA,GAFA;EAGA;AArEA","names":["name","components","HCommentArea","HCommentDisplay","props","isReverse","type","default","data","isReplyState","states","idToName","methods","onReplyStateChange","id","initCommentId","comments","item","countCommentNum","n","computed","title","mounted","setTimeout"],"sourceRoot":"src/components/comment","sources":["h-comment.vue"],"sourcesContent":["<template>\r\n    <div class=\"h-comment-wrapper\"\r\n         :style=\"`flex-direction: ${isReverse ? 'column-reverse' : 'column'}`\">\r\n        <h-comment-area v-if=\"isReplyState\" :isReplyState=\"isReplyState\"></h-comment-area>\r\n        <div class=\"comment-title\" v-if=\"!isReverse\">{{ title }}</div>\r\n        <h-comment-display :comments=\"$store.getters['comment/getCommentsByPath']\"\r\n                           :isReplyState=\"isReplyState\"\r\n                           :states=\"states\"\r\n                           :idToName=\"idToName\"\r\n                           :onReplyStateChange=\"onReplyStateChange\"></h-comment-display>\r\n        <div class=\"comment-title\" v-if=\"isReverse\">{{ title }}</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import HCommentDisplay from \"@/components/comment/h-comment-display\";\r\n    import HCommentArea from \"@/components/comment/h-comment-area\";\r\n\r\n\r\n    export default {\r\n        name: \"HComment\",\r\n        components: {HCommentArea, HCommentDisplay},\r\n        props: {\r\n            isReverse: {type: Boolean, default: false}\r\n        },\r\n        data() {\r\n            return {\r\n                isReplyState: true,\r\n                states: {},\r\n                idToName: {}\r\n            }\r\n        },\r\n        methods: {\r\n            onReplyStateChange(id) {\r\n                const comments = this.$store.getters[\"comment/getCommentsByPath\"];\r\n                if (id !== 'init') {\r\n                    const state = this.states[id]; // 取出当前回复的状态\r\n\r\n                    this.initCommentId(comments) // 初始化所以评论下的状态为false\r\n                    this.$set(this.states, id, !state)\r\n                    this.isReplyState = Object.keys(this.states).every(k => this.states[k] === false);\r\n                } else {\r\n                    this.isReplyState = true;\r\n                    this.initCommentId(comments)\r\n                }\r\n            },\r\n            initCommentId(comments) {\r\n                if (comments === null || comments.length === 0) return;\r\n                comments.forEach(item => {\r\n                    if (item.sub.length > 0) {\r\n                        this.initCommentId(item.sub);\r\n                    }\r\n                    this.idToName[item._id] = item.name;\r\n                    item._id && this.$set(this.states, item._id, false)\r\n                })\r\n            },\r\n            countCommentNum(comments) {\r\n                if (comments === null || comments.length === 0) return;\r\n                let n = 0;\r\n                comments.forEach(item => {\r\n                    item.sub.length > 0 && (n += item.sub.length)\r\n                    n++;\r\n                })\r\n                return n;\r\n            }\r\n        },\r\n        computed: {\r\n            title() {\r\n                const comments = this.$store.getters[\"comment/getCommentsByPath\"];\r\n                let n = this.countCommentNum(comments) || 0;\r\n                let title = '';\r\n                if (comments.length === 0) {\r\n                    if (this.$route.path !== '/message') {\r\n                        title = '暂无评论'\r\n                    } else {\r\n                        title = '暂无留言'\r\n                    }\r\n                } else {\r\n                    title = '共' + n + '条评论';\r\n                    if (this.$route.path === '/message') title = '共' + n + '条留言';\r\n                }\r\n                return title\r\n            }\r\n        },\r\n        mounted() {\r\n            setTimeout(() => {\r\n                this.initCommentId(this.$store.getters[\"comment/getCommentsByPath\"])\r\n            }, 200)\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n    .h-comment-wrapper {\r\n        display: flex;\r\n    }\r\n\r\n    .comment-title {\r\n        width: 80%;\r\n        margin: 0 auto;\r\n        font-size: 1.8em;\r\n        font-weight: bolder;\r\n        letter-spacing: 5px;\r\n        color: #34495E;\r\n        transition: .7s;\r\n        padding: 10px 15px;\r\n        border-radius: 5px;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .comment-title:active {\r\n        transform: rotateX(360deg);\r\n        text-align: right;\r\n        background-color: #409eff;\r\n    }\r\n\r\n</style>"]}]}