{"remainingRequest":"D:\\桌面\\vdocs-plus\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\桌面\\vdocs-plus\\src\\components\\comment\\h-comment.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\桌面\\vdocs-plus\\src\\components\\comment\\h-comment.vue","mtime":1660971313631},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661267353134},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\babel-loader\\lib\\index.js","mtime":1661267356503},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661267353134},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\vue-loader\\lib\\index.js","mtime":1661267357130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIQ29tbWVudERpc3BsYXkgZnJvbSAiQC9jb21wb25lbnRzL2NvbW1lbnQvaC1jb21tZW50LWRpc3BsYXkiOwppbXBvcnQgSENvbW1lbnRBcmVhIGZyb20gIkAvY29tcG9uZW50cy9jb21tZW50L2gtY29tbWVudC1hcmVhIjsKCgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiSENvbW1lbnQiLAogICAgY29tcG9uZW50czoge0hDb21tZW50QXJlYSwgSENvbW1lbnREaXNwbGF5fSwKICAgIHByb3BzOiB7CiAgICAgICAgaXNSZXZlcnNlOiB7dHlwZTogQm9vbGVhbiwgZGVmYXVsdDogZmFsc2V9CiAgICB9LAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpc1JlcGx5U3RhdGU6IHRydWUsCiAgICAgICAgICAgIHN0YXRlczoge30sCiAgICAgICAgICAgIGlkVG9OYW1lOiB7fQogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgb25SZXBseVN0YXRlQ2hhbmdlKGlkKSB7CiAgICAgICAgICAgIGNvbnN0IGNvbW1lbnRzID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1siY29tbWVudC9nZXRDb21tZW50c0J5UGF0aCJdOwogICAgICAgICAgICBpZiAoaWQgIT09ICdpbml0JykgewogICAgICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSB0aGlzLnN0YXRlc1tpZF07IC8vIOWPluWHuuW9k+WJjeWbnuWkjeeahOeKtuaAgQoKICAgICAgICAgICAgICAgIHRoaXMuaW5pdENvbW1lbnRJZChjb21tZW50cykgLy8g5Yid5aeL5YyW5omA5Lul6K+E6K665LiL55qE54q25oCB5Li6ZmFsc2UKICAgICAgICAgICAgICAgIHRoaXMuJHNldCh0aGlzLnN0YXRlcywgaWQsICFzdGF0ZSkKICAgICAgICAgICAgICAgIHRoaXMuaXNSZXBseVN0YXRlID0gT2JqZWN0LmtleXModGhpcy5zdGF0ZXMpLmV2ZXJ5KGsgPT4gdGhpcy5zdGF0ZXNba10gPT09IGZhbHNlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuaXNSZXBseVN0YXRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMuaW5pdENvbW1lbnRJZChjb21tZW50cykKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgaW5pdENvbW1lbnRJZChjb21tZW50cykgewogICAgICAgICAgICBpZiAoY29tbWVudHMgPT09IG51bGwgfHwgY29tbWVudHMubGVuZ3RoID09PSAwKSByZXR1cm47CiAgICAgICAgICAgIGNvbW1lbnRzLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5zdWIubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdENvbW1lbnRJZChpdGVtLnN1Yik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB0aGlzLmlkVG9OYW1lW2l0ZW0uX2lkXSA9IGl0ZW0ubmFtZTsKICAgICAgICAgICAgICAgIGl0ZW0uX2lkICYmIHRoaXMuJHNldCh0aGlzLnN0YXRlcywgaXRlbS5faWQsIGZhbHNlKQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgY291bnRDb21tZW50TnVtKGNvbW1lbnRzKSB7CiAgICAgICAgICAgIGlmIChjb21tZW50cyA9PT0gbnVsbCB8fCBjb21tZW50cy5sZW5ndGggPT09IDApIHJldHVybjsKICAgICAgICAgICAgbGV0IG4gPSAwOwogICAgICAgICAgICBjb21tZW50cy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgICAgICAgaXRlbS5zdWIubGVuZ3RoID4gMCAmJiAobiArPSBpdGVtLnN1Yi5sZW5ndGgpCiAgICAgICAgICAgICAgICBuKys7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHJldHVybiBuOwogICAgICAgIH0KICAgIH0sCiAgICBjb21wdXRlZDogewogICAgICAgIHRpdGxlKCkgewogICAgICAgICAgICBjb25zdCBjb21tZW50cyA9IHRoaXMuJHN0b3JlLmdldHRlcnNbImNvbW1lbnQvZ2V0Q29tbWVudHNCeVBhdGgiXTsKICAgICAgICAgICAgbGV0IG4gPSB0aGlzLmNvdW50Q29tbWVudE51bShjb21tZW50cykgfHwgMDsKICAgICAgICAgICAgbGV0IHRpdGxlID0gJyc7CiAgICAgICAgICAgIGlmIChjb21tZW50cy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXRoICE9PSAnL21lc3NhZ2UnKSB7CiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSAn5pqC5peg6K+E6K66JwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aXRsZSA9ICfmmoLml6DnlZnoqIAnCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aXRsZSA9ICflhbEnICsgbiArICfmnaHor4TorronOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhdGggPT09ICcvbWVzc2FnZScpIHRpdGxlID0gJ+WFsScgKyBuICsgJ+adoeeVmeiogCc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRpdGxlCiAgICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuaW5pdENvbW1lbnRJZCh0aGlzLiRzdG9yZS5nZXR0ZXJzWyJjb21tZW50L2dldENvbW1lbnRzQnlQYXRoIl0pCiAgICAgICAgfSwgMjAwKQogICAgfQp9Cg=="},{"version":3,"sources":["h-comment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"h-comment.vue","sourceRoot":"src/components/comment","sourcesContent":["<template>\r\n    <div class=\"h-comment-wrapper\"\r\n         :style=\"`flex-direction: ${isReverse ? 'column-reverse' : 'column'}`\">\r\n        <h-comment-area v-if=\"isReplyState\" :isReplyState=\"isReplyState\"></h-comment-area>\r\n        <div class=\"comment-title\" v-if=\"!isReverse\">{{ title }}</div>\r\n        <h-comment-display :comments=\"$store.getters['comment/getCommentsByPath']\"\r\n                           :isReplyState=\"isReplyState\"\r\n                           :states=\"states\"\r\n                           :idToName=\"idToName\"\r\n                           :onReplyStateChange=\"onReplyStateChange\"></h-comment-display>\r\n        <div class=\"comment-title\" v-if=\"isReverse\">{{ title }}</div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import HCommentDisplay from \"@/components/comment/h-comment-display\";\r\n    import HCommentArea from \"@/components/comment/h-comment-area\";\r\n\r\n\r\n    export default {\r\n        name: \"HComment\",\r\n        components: {HCommentArea, HCommentDisplay},\r\n        props: {\r\n            isReverse: {type: Boolean, default: false}\r\n        },\r\n        data() {\r\n            return {\r\n                isReplyState: true,\r\n                states: {},\r\n                idToName: {}\r\n            }\r\n        },\r\n        methods: {\r\n            onReplyStateChange(id) {\r\n                const comments = this.$store.getters[\"comment/getCommentsByPath\"];\r\n                if (id !== 'init') {\r\n                    const state = this.states[id]; // 取出当前回复的状态\r\n\r\n                    this.initCommentId(comments) // 初始化所以评论下的状态为false\r\n                    this.$set(this.states, id, !state)\r\n                    this.isReplyState = Object.keys(this.states).every(k => this.states[k] === false);\r\n                } else {\r\n                    this.isReplyState = true;\r\n                    this.initCommentId(comments)\r\n                }\r\n            },\r\n            initCommentId(comments) {\r\n                if (comments === null || comments.length === 0) return;\r\n                comments.forEach(item => {\r\n                    if (item.sub.length > 0) {\r\n                        this.initCommentId(item.sub);\r\n                    }\r\n                    this.idToName[item._id] = item.name;\r\n                    item._id && this.$set(this.states, item._id, false)\r\n                })\r\n            },\r\n            countCommentNum(comments) {\r\n                if (comments === null || comments.length === 0) return;\r\n                let n = 0;\r\n                comments.forEach(item => {\r\n                    item.sub.length > 0 && (n += item.sub.length)\r\n                    n++;\r\n                })\r\n                return n;\r\n            }\r\n        },\r\n        computed: {\r\n            title() {\r\n                const comments = this.$store.getters[\"comment/getCommentsByPath\"];\r\n                let n = this.countCommentNum(comments) || 0;\r\n                let title = '';\r\n                if (comments.length === 0) {\r\n                    if (this.$route.path !== '/message') {\r\n                        title = '暂无评论'\r\n                    } else {\r\n                        title = '暂无留言'\r\n                    }\r\n                } else {\r\n                    title = '共' + n + '条评论';\r\n                    if (this.$route.path === '/message') title = '共' + n + '条留言';\r\n                }\r\n                return title\r\n            }\r\n        },\r\n        mounted() {\r\n            setTimeout(() => {\r\n                this.initCommentId(this.$store.getters[\"comment/getCommentsByPath\"])\r\n            }, 200)\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n    .h-comment-wrapper {\r\n        display: flex;\r\n    }\r\n\r\n    .comment-title {\r\n        width: 80%;\r\n        margin: 0 auto;\r\n        font-size: 1.8em;\r\n        font-weight: bolder;\r\n        letter-spacing: 5px;\r\n        color: #34495E;\r\n        transition: .7s;\r\n        padding: 10px 15px;\r\n        border-radius: 5px;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .comment-title:active {\r\n        transform: rotateX(360deg);\r\n        text-align: right;\r\n        background-color: #409eff;\r\n    }\r\n\r\n</style>"]}]}