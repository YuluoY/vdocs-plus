{"remainingRequest":"D:\\桌面\\vdocs-plus\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\桌面\\vdocs-plus\\src\\components\\comment\\h-comment-area.vue?vue&type=style&index=0&id=7e48bf80&scoped=true&lang=scss&","dependencies":[{"path":"D:\\桌面\\vdocs-plus\\src\\components\\comment\\h-comment-area.vue","mtime":1660980617730},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\css-loader\\dist\\cjs.js","mtime":1661267354466},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1661267358739},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\postcss-loader\\src\\index.js","mtime":1661267356452},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1661267353103},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1661267353134},{"path":"D:\\桌面\\vdocs-plus\\node_modules\\vue-loader\\lib\\index.js","mtime":1661267357130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmgtY29tbWVudC1hcmVhIHsKICAuaC1jb21tZW50IHsKICAgIHdpZHRoOiA4MGVtOwogICAgYm9yZGVyLXJhZGl1czogNXB4OwogICAgYm94LXNoYWRvdzogMHB4IDBweCAxMHB4IHNpbHZlcjsKICAgIG1hcmdpbjogMzBweCBhdXRvOwogICAgZm9udC1zaXplOiAuOGVtOwogICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgei1pbmRleDogMTA7CgogICAgLmhlYWRlciB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIHBhZGRpbmc6IDAgMWVtOwoKICAgICAgLmltZyB7CiAgICAgICAgaW1nIHsKICAgICAgICAgIHdpZHRoOiA1MHB4OwogICAgICAgICAgaGVpZ2h0OiA1MHB4OwogICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4OwogICAgICAgICAgbWFyZ2luLXRvcDogMTBweDsKICAgICAgICAgIG1hcmdpbi1yaWdodDogMTBweDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIC5uYW1lIHsKICAgICAgICBsaW5lLWhlaWdodDogNzhweDsKICAgICAgICBmbGV4OiAxOwogICAgICB9CgogICAgICAuZW1haWwgewogICAgICAgIGxpbmUtaGVpZ2h0OiA3OHB4OwogICAgICAgIGZsZXg6IDE7CiAgICAgIH0KCiAgICAgIC5hZGRyZXNzIHsKICAgICAgICBsaW5lLWhlaWdodDogNzhweDsKICAgICAgICBmbGV4OiAxOwogICAgICB9CgogICAgICBpbnB1dCB7CiAgICAgICAgbGluZS1oZWlnaHQ6IDNlbTsKICAgICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBkYXNoZWQgcmdiYSgwLCAwLCAwLCAwLjIpOwogICAgICAgIGZvbnQtc2l6ZTogMS4zZW07CgogICAgICAgICY6Zm9jdXMgewogICAgICAgICAgb3V0bGluZTogbm9uZTsKICAgICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBkYXNoZWQgIzQwOWVmZjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICAuY2VudGVyIHsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKCiAgICAgIC5jb250ZW50IHsKICAgICAgICB3aWR0aDogOTglOwogICAgICAgIG1hcmdpbjogMCBhdXRvOwogICAgICAgIHBhZGRpbmc6IDFlbTsKCiAgICAgICAgLnRleHRhcmVhIHsKICAgICAgICAgIG91dGxpbmU6IG5vbmU7CiAgICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7CiAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgIG1pbi1oZWlnaHQ6IDIyMHB4OwogICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgIGZvbnQtZmFtaWx5OiDlrovkvZMsIHNhbnMtc2VyaWY7CiAgICAgICAgICBmb250LXNpemU6IDEuMmVtOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC5mb290ZXIgewogICAgICBib3JkZXItdG9wOiBkYXNoZWQgMXB4IHNpbHZlcjsKICAgICAgZGlzcGxheTogZmxleDsKCiAgICAgIC5mdW5jdGlvbiB7CiAgICAgICAgZmxleC1ncm93OiAxOwogICAgICAgIHRleHQtYWxpZ246IHJpZ2h0OwoKICAgICAgICBzcGFuIHsKICAgICAgICAgIHVzZXItc2VsZWN0OiBub25lOwogICAgICAgICAgYm9yZGVyOiBkYXNoZWQgMS41cHggc2lsdmVyOwogICAgICAgICAgbGluZS1oZWlnaHQ6IDNlbTsKICAgICAgICAgIHBhZGRpbmc6IDdweDsKICAgICAgICAgIG1hcmdpbi1yaWdodDogNXB4OwogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdW5zZXQ7CiAgICAgICAgICBmb250LXNpemU6IDEuNGVtOwogICAgICAgICAgdHJhbnNpdGlvbjogMXM7CiAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjcpOwoKICAgICAgICAgICY6aG92ZXIgewogICAgICAgICAgICBjb2xvcjogIzQwOWVmZjsKICAgICAgICAgICAgYm9yZGVyOiBzb2xpZCAxLjVweCAjNDA5ZWZmOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgLmNvdW50IHsKICAgICAgICB3aWR0aDogYXV0bzsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgcGFkZGluZzogMWVtOwoKICAgICAgICAud29yZHMgewogICAgICAgICAgZm9udC1zaXplOiAxLjJlbTsKICAgICAgICAgIGNvbG9yOiBzaWx2ZXI7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgLmNsb3NlLXN1Yi1jb21tZW50LWFyZWEgewogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHJpZ2h0OiAxMHB4OwogICAgICB0b3A6IDEwcHg7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICB6LWluZGV4OiA5OTk5OTk5OTk5OwogICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIGZvbnQtc2l6ZTogMmVtOwogICAgICBjb2xvcjogc2lsdmVyOwogICAgICBib3JkZXI6IGRhc2hlZCAxLjVweCBzaWx2ZXI7CiAgICAgIHRyYW5zaXRpb246IDFzOwoKICAgICAgZGl2IHsKICAgICAgICBwYWRkaW5nOiAwIDhweDsKICAgICAgfQoKICAgICAgJjpob3ZlciB7CiAgICAgICAgYm9yZGVyOiBzb2xpZCAxLjVweCAjNDA5ZWZmOwogICAgICAgIGNvbG9yOiAjNDA5ZWZmOwogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["h-comment-area.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"h-comment-area.vue","sourceRoot":"src/components/comment","sourcesContent":["<template>\r\n    <div class=\"h-comment-area\">\r\n        <div class=\"h-comment\">\r\n            <div class=\"header\">\r\n                <div class=\"img\">\r\n                    <img :src=\"model.imgUrl\"/>\r\n                </div>\r\n                <div class=\"name\">\r\n                    <input v-model.trim=\"model.name\" :placeholder=\"hints.nameHint\" @focusout=\"getUserInfo\"/>\r\n                </div>\r\n                <div class=\"email\">\r\n                    <input v-model.trim=\"model.email\" :placeholder=\"hints.emailHint\"/>\r\n                </div>\r\n                <div class=\"address\">\r\n                    <input v-model.trim=\"model.address\" :placeholder=\"hints.addressHint\"/>\r\n                </div>\r\n            </div>\r\n            <div class=\"center\">\r\n                <div class=\"content\">\r\n                    <div\r\n                            ref=\"textarea\"\r\n                            class=\"textarea\"\r\n                            @input=\"onChangeContent\"\r\n                            :style=\"`color:${model.words ? 'black':'silver'}`\"\r\n                            @focus=\"!model.words && ($refs.textarea.innerText = '')\"\r\n                            @focusout=\"!model.words && ($refs.textarea.innerHTML = hints.contentHint)\"\r\n                            contenteditable=\"true\">\r\n                        {{ hints.contentHint }}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"footer\">\r\n                <div class=\"count\">\r\n                    <div class=\"words\">字数统计：{{ model.words }}</div>\r\n                </div>\r\n                <div class=\"function\">\r\n                    <span @click.prevent=\"onRelease\">发布</span>\r\n                </div>\r\n            </div>\r\n            <div class=\"close-sub-comment-area\"\r\n                 @click=\"$emit('onReplyStateChange','init')\"\r\n                 v-if=\"!isReplyState\">\r\n                <svg-icon icon-class=\"close\"></svg-icon>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import {mapState} from \"vuex\";\r\n\r\n    export default {\r\n        name: \"HCommentArea\",\r\n        props: {\r\n            isReplyState: Boolean,\r\n            id: String,\r\n        },\r\n        data() {\r\n            return {\r\n                model: {\r\n                    imgUrl: require('@/assets/img/1.jpg'),\r\n                    name: '',\r\n                    email: '',\r\n                    address: '',\r\n                    content: '',\r\n                    words: 0,\r\n                    cname: ''\r\n                },\r\n                hints: {\r\n                    nameHint: 'QQ/匿名昵称',\r\n                    emailHint: '邮箱',\r\n                    addressHint: '博客网址',\r\n                    contentHint: '是时候展现你真正的技术了！（提示：输入QQ号会自动填写头像和邮箱哦~）',\r\n                }\r\n            }\r\n        },\r\n        computed: mapState({\r\n            browserType: state => state.app.browserType,\r\n        }),\r\n        methods: {\r\n            // 发布评论\r\n            async onRelease() {\r\n                if (this.model.content.trim() === '') {\r\n                    this.$message.warning('您还没有填写任何评论哦！')\r\n                    return;\r\n                }\r\n                const brandInfo = navigator.userAgent.replace(/(\\()|(\\))/g, '').split(' ');\r\n                const system = `${brandInfo[1]} ${brandInfo[3]}`.replace(/(\\.0)|(;)/g, '');\r\n                let browser = this.browserType;\r\n\r\n                if (this.browserType === 'Chrome') {\r\n                    browser = brandInfo[10].replace(/(\\/)/g, ' ');\r\n                } else if (this.browserType === 'Firefox') {\r\n                    browser = brandInfo[8].replace(/(\\/)/g, ' ');\r\n                } else if (this.browserType === 'QQBrowser') {\r\n                    browser = brandInfo[12].replace(/(\\/)/g, ' ');\r\n                }\r\n\r\n                this.model.name === '' && (this.model.name = 'Anonymous')\r\n                this.model.address === '' && (this.model.address = '#')\r\n                this.model.system = system; // 操作系统\r\n                this.model.browser = browser; // 浏览器参数\r\n                this.model.path = decodeURI(this.$route.path);  // 页面\r\n\r\n                const userInfo = (await this.$apis.rest.getUserIp()).data;\r\n                if (process.env.VUE_APP_BASE_API === 'http://localhost:3000') {\r\n                    this.model.cname = userInfo.cname\r\n                } else {\r\n                    this.model.cname = userInfo.province;\r\n                }\r\n\r\n                if (this.id) {\r\n                    this.model.sub = this.id\r\n                    this.model.isSub = true;\r\n                }\r\n\r\n                const res = await this.$apis.web.addComment(this.model);\r\n                if (res) {\r\n                    this.$notify.success(`${this.model.name}成功发布一条评论！`)\r\n                    this.$refs.textarea.innerHTML = this.hints.contentHint;\r\n                    this.model = {\r\n                        imgUrl: require('@/assets/img/1.jpg'),\r\n                        name: '',\r\n                        email: '',\r\n                        address: '',\r\n                        content: '',\r\n                        words: 0,\r\n                    }\r\n                    this.$store.commit('comment/setCommentsByPath', this);\r\n                    this.$emit('onReplyStateChange', 'init')\r\n                }\r\n            },\r\n\r\n            onChangeContent() {\r\n                this.model.content = this.$refs.textarea.innerText;\r\n                this.model.words = this.replaceAll(this.model.content,\r\n                    ['&nbsp;', ' ', '<br>', '<div>', '</div>'], '').length;\r\n            },\r\n            getUserInfo() {\r\n                const user = JSON.parse(localStorage.getItem('userQQInfo') || \"{}\").data;\r\n                // if (user && user.name === this.name) return;\r\n                if (this.model.name) {\r\n                    const xhr = new XMLHttpRequest();\r\n                    xhr.open('GET', 'https://api.usuuu.com/qq/' + this.model.name);\r\n                    xhr.send();\r\n                    xhr.onreadystatechange = () => {\r\n                        if (xhr.readyState === 4) {\r\n                            if (xhr.status >= 200 && xhr.status < 300) {\r\n                                localStorage.setItem('userQQInfo', xhr.response);\r\n                                const data = JSON.parse(xhr.response).data;\r\n                                this.model.name = data.name;\r\n                                this.model.imgUrl = data.avatar;\r\n                                this.model.email = `${data.qq}@qq.com`\r\n                            } else {\r\n                                this.model.imgUrl = require('@/assets/img/1.jpg');\r\n                                this.model.email = ''\r\n                            }\r\n                        }\r\n                    }\r\n                } else {\r\n                    this.model.imgUrl = require('@/assets/img/1.jpg');\r\n                    this.model.email = ''\r\n                }\r\n            },\r\n\r\n            replaceAll(str, searchVal, replVal) {\r\n                if (typeof searchVal === \"string\") {\r\n                    str = str.replaceAll(searchVal, replVal);\r\n                } else if (typeof searchVal === 'object') {\r\n                    searchVal.forEach(s => str = str.replaceAll(s, replVal))\r\n                }\r\n                return str;\r\n            }\r\n        },\r\n        mounted() {\r\n            const data = JSON.parse(localStorage.getItem('userQQInfo') || '{}').data;\r\n            if (data) {\r\n                this.model.name = data.name;\r\n                this.model.imgUrl = data.avatar;\r\n                this.model.email = `${data.qq}@qq.com`\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n  .h-comment-area {\r\n    .h-comment {\r\n      width: 80em;\r\n      border-radius: 5px;\r\n      box-shadow: 0px 0px 10px silver;\r\n      margin: 30px auto;\r\n      font-size: .8em;\r\n      position: relative;\r\n      z-index: 10;\r\n\r\n      .header {\r\n        display: flex;\r\n        padding: 0 1em;\r\n\r\n        .img {\r\n          img {\r\n            width: 50px;\r\n            height: 50px;\r\n            border-radius: 5px;\r\n            margin-top: 10px;\r\n            margin-right: 10px;\r\n          }\r\n        }\r\n\r\n        .name {\r\n          line-height: 78px;\r\n          flex: 1;\r\n        }\r\n\r\n        .email {\r\n          line-height: 78px;\r\n          flex: 1;\r\n        }\r\n\r\n        .address {\r\n          line-height: 78px;\r\n          flex: 1;\r\n        }\r\n\r\n        input {\r\n          line-height: 3em;\r\n          display: inline-block;\r\n          width: 100%;\r\n          border: none;\r\n          border-bottom: 1px dashed rgba(0, 0, 0, 0.2);\r\n          font-size: 1.3em;\r\n\r\n          &:focus {\r\n            outline: none;\r\n            border: none;\r\n            border-bottom: 1px dashed #409eff;\r\n          }\r\n        }\r\n      }\r\n\r\n      .center {\r\n        width: 100%;\r\n        position: relative;\r\n\r\n        .content {\r\n          width: 98%;\r\n          margin: 0 auto;\r\n          padding: 1em;\r\n\r\n          .textarea {\r\n            outline: none;\r\n            border: none;\r\n            word-break: break-all;\r\n            width: 100%;\r\n            min-height: 220px;\r\n            overflow: hidden;\r\n            font-family: 宋体, sans-serif;\r\n            font-size: 1.2em;\r\n          }\r\n        }\r\n      }\r\n\r\n      .footer {\r\n        border-top: dashed 1px silver;\r\n        display: flex;\r\n\r\n        .function {\r\n          flex-grow: 1;\r\n          text-align: right;\r\n\r\n          span {\r\n            user-select: none;\r\n            border: dashed 1.5px silver;\r\n            line-height: 3em;\r\n            padding: 7px;\r\n            margin-right: 5px;\r\n            background-color: unset;\r\n            font-size: 1.4em;\r\n            transition: 1s;\r\n            cursor: pointer;\r\n            color: rgba(0, 0, 0, 0.7);\r\n\r\n            &:hover {\r\n              color: #409eff;\r\n              border: solid 1.5px #409eff;\r\n            }\r\n          }\r\n        }\r\n\r\n        .count {\r\n          width: auto;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          padding: 1em;\r\n\r\n          .words {\r\n            font-size: 1.2em;\r\n            color: silver;\r\n          }\r\n        }\r\n      }\r\n\r\n      .close-sub-comment-area {\r\n        position: absolute;\r\n        right: 10px;\r\n        top: 10px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        z-index: 9999999999;\r\n        cursor: pointer;\r\n        font-size: 2em;\r\n        color: silver;\r\n        border: dashed 1.5px silver;\r\n        transition: 1s;\r\n\r\n        div {\r\n          padding: 0 8px;\r\n        }\r\n\r\n        &:hover {\r\n          border: solid 1.5px #409eff;\r\n          color: #409eff;\r\n        }\r\n      }\r\n    }\r\n  }\r\n</style>"]}]}